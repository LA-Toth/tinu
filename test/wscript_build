def add_test(bld, name):
  task = bld.new_task_gen('cc', 'cprogram')
  task.target = 'test_%s' % name
  task.includes = '. # ../lib ../lib/tinu'
  task.source = 'test_%s.c' % name
  task.install_path = None
  task.add_objects = 'static_tinu'
  task.uselib = 'GLIB GTHREAD DL'

  task.cflags = ['-g']
  task.ldflags = ['-Wl,-E', '-rdynamic']

add_test(bld, 'backtrace')
add_test(bld, 'leakwatch')
add_test(bld, 'main')

# vim: syntax=python

